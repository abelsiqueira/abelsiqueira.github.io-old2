__NUXT_JSONP__("/blog/2015-01-12-instalando-o-ubuntu-1410-no-sony-vaio", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){return {data:[{page:{slug:"2015-01-12-instalando-o-ubuntu-1410-no-sony-vaio",title:q,date:"2015-01-12",tags:["tech","ubuntu","work","install"],toc:[],body:{type:"root",children:[{type:b,tag:"h1",props:{id:"instalando-o-ubuntu-1410-no-sony-vaio-problemas-com-o-ssd"},children:[{type:b,tag:k,props:{href:"#instalando-o-ubuntu-1410-no-sony-vaio-problemas-com-o-ssd",ariaHidden:"true",tabIndex:-1},children:[{type:b,tag:"span",props:{className:["icon","icon-link"]},children:[]}]},{type:a,value:q}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"Hoje instalei em dual-boot o Ubuntu 14.10 e o windows 8.\nNão tive problemas com o UEFI, nem secure boot.\nNão tenho certeza, mas talvez o windows não seja o que veio\nde fábrica."}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"Eu já tinha um USB com o Ubuntu 14.10, então pluguei-o\ne bootei o computador.\nF12-F12-F12-F12... A tela de seleção de boot não apareceu,\nmas o usb foi escolhido automaticamente."}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"O ubuntu bootou e selecionei instalar.\nEscolhi o particionamento manual,\nque é minha escolha usual.\nNormalmente faço o particionamento manual,\nporque não gosto quando eles criam (criavam, não sei\nse continuam) apenas o "},{type:b,tag:c,props:{},children:[{type:a,value:l}]},{type:a,value:" e o "},{type:b,tag:c,props:{},children:[{type:a,value:r}]},{type:a,value:".\nO windows estava instalado em duas partições num SSD.\nSelecionei a correspondente, redimensionei, criei 3 partições lógicas\n("},{type:b,tag:c,props:{},children:[{type:a,value:l}]},{type:a,value:s},{type:b,tag:c,props:{},children:[{type:a,value:r}]},{type:a,value:", e "},{type:b,tag:c,props:{},children:[{type:a,value:"\u002Fhome"}]},{type:a,value:"), e mandei instalar.\nA instalação não teve problemas. Aí eu bootei e deu erro."}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"O primeiro erro que apareceu foi"}]},{type:a,value:d},{type:b,tag:f,props:{className:[g]},children:[{type:b,tag:h,props:{className:[i,j]},children:[{type:b,tag:c,props:{},children:[{type:a,value:"tpm_tis: A TPM error (6) occurred attempting to read a pcr value\n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"Que depois descobri que era proveniente do\n"},{type:b,tag:k,props:{href:"https:\u002F\u002Fwiki.archlinux.org\u002Findex.php\u002FTPM",rel:[m,n,o],target:p},children:[{type:a,value:"Trusted Platform Module"}]},{type:a,value:".\nDepois de pouca busca, descobri que bastava entrar na BIOS e habilitar o\nTPM. A saber, para entrar na BIOS no Sony Vaio, desligue o computador e\naperte o botão ASSIST.\nHabilitei o TPM, mas não sei o que ele faz na prática. No entanto,\naparentemente, o computador continuou funcionando normalmente."}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"O segundo erro que apareceu, que já aparecia junto com o primeiro, mas\nque só olhei depois, foi algo na linha de"}]},{type:a,value:d},{type:b,tag:f,props:{className:[g]},children:[{type:b,tag:h,props:{className:[i,j]},children:[{type:b,tag:c,props:{},children:[{type:a,value:"[ 9.115544] ata9: exception Emask 0x0 SAct 0xf SErr 0x0 action 0x10 frozen\n[ 9.115550] ata9.00: failed command: READ FPDMA QUEUED\n[ 9.115556] ata9.00: cmd 60\u002F04:00:d4:82:85\u002F00:00:1f:00:00\u002F40 tag 0 ncq 2048 in\n[ 9.115557] res 40\u002F00:18:d3:82:85\u002F00:00:1f:00:00\u002F40 Emask 0x4 (timeout)\n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"Após alguma busca descobri ser um erro de Native Command Queueing com SSDs.\nA solução\n"},{type:b,tag:k,props:{href:"http:\u002F\u002Fsteffankarger.nl\u002F2013\u002F12\u002F10\u002Fubuntu-13-10-on-the-sony-vaio-pro-13\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"[1]"}]},{type:a,value:d},{type:b,tag:k,props:{href:"http:\u002F\u002Fwww.howtoeverything.net\u002Flinux\u002Fhardware\u002Fubuntu-freeze-issue-after-ssd-upgrade",rel:[m,n,o],target:p},children:[{type:a,value:"[2]"}]},{type:a,value:d},{type:b,tag:k,props:{href:"https:\u002F\u002Fwiki.archlinux.org\u002Findex.php\u002FSolid_State_Drives#Resolving_NCQ_Errors",rel:[m,n,o],target:p},children:[{type:a,value:"[3]"}]},{type:a,value:"\nfoi adicionar "},{type:b,tag:c,props:{},children:[{type:a,value:t}]},{type:a,value:" na configuração do grub.\nPara isso, resumindo a referência, boot no live,\nmonte o "},{type:b,tag:c,props:{},children:[{type:a,value:l}]},{type:a,value:" com bind pro "},{type:b,tag:c,props:{},children:[{type:a,value:"\u002Fdev"}]},{type:a,value:s},{type:b,tag:c,props:{},children:[{type:a,value:"\u002Fsys"}]},{type:a,value:" e "},{type:b,tag:c,props:{},children:[{type:a,value:"\u002Fproc"}]},{type:a,value:", e se tiver separado, o "},{type:b,tag:c,props:{},children:[{type:a,value:"\u002Fboot"}]},{type:a,value:"\ntambém. Os comandos a seguir fazem isso, supondo "},{type:b,tag:c,props:{},children:[{type:a,value:l}]},{type:a,value:" instalado no "},{type:b,tag:c,props:{},children:[{type:a,value:"\u002Fdev\u002Fsda5"}]},{type:a,value:"."}]},{type:a,value:d},{type:b,tag:f,props:{className:[g]},children:[{type:b,tag:h,props:{className:[i,j]},children:[{type:b,tag:c,props:{},children:[{type:a,value:"$ sudo mount \u002Fdev\u002Fsda5 \u002Fmnt\n$ sudo mount --bind \u002Fdev \u002Fmnt\u002Fdev\n$ sudo mount --bind \u002Fsys \u002Fmnt\u002Fsys\n$ sudo mount --bind \u002Fproc \u002Fmnt\u002Fproc\n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"Daí, entre nesse sistema com"}]},{type:a,value:d},{type:b,tag:f,props:{className:[g]},children:[{type:b,tag:h,props:{className:[i,j]},children:[{type:b,tag:c,props:{},children:[{type:a,value:"$ sudo chroot \u002Fmnt\n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"No sistema novo, edite o arquivo "},{type:b,tag:c,props:{},children:[{type:a,value:"\u002Fetc\u002Fdefault\u002Fgrub"}]},{type:a,value:", modificando a linha"}]},{type:a,value:d},{type:b,tag:f,props:{className:[g]},children:[{type:b,tag:h,props:{className:[i,j]},children:[{type:b,tag:c,props:{},children:[{type:a,value:"GRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash\"\n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"para"}]},{type:a,value:d},{type:b,tag:f,props:{className:[g]},children:[{type:b,tag:h,props:{className:[i,j]},children:[{type:b,tag:c,props:{},children:[{type:a,value:"GRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash libata.force=noncq\"\n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"e atualize o grub com"}]},{type:a,value:d},{type:b,tag:f,props:{className:[g]},children:[{type:b,tag:h,props:{className:[i,j]},children:[{type:b,tag:c,props:{},children:[{type:a,value:"$ sudo update-grub\n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"Saia e desmonte as partições"}]},{type:a,value:d},{type:b,tag:f,props:{className:[g]},children:[{type:b,tag:h,props:{className:[i,j]},children:[{type:b,tag:c,props:{},children:[{type:a,value:"$ exit\n$ sudo umount -R \u002Fmnt\n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"Por fim é só reiniciar e ver se funcionou."}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"Agora, a parte divertida dessa instalação, que durou quase 3 horas (!) foi em\nalgum lugar eu li, ou achei ter lido "},{type:b,tag:c,props:{},children:[{type:a,value:"libdata"}]},{type:a,value:" no lugar de "},{type:b,tag:c,props:{},children:[{type:a,value:u}]},{type:a,value:", e pareceu\nque essa solução não resolveu. E isso não é o pior, eu cheguei a buscar\n"},{type:b,tag:c,props:{},children:[{type:a,value:"libdata.force=noncq"}]},{type:a,value:", o google me corrigiu pra "},{type:b,tag:c,props:{},children:[{type:a,value:t}]},{type:a,value:", e eu\ncheguei a ler depois o "},{type:b,tag:c,props:{},children:[{type:a,value:u}]},{type:a,value:" e achei que era outra opção."}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"Mas tirando isso, instalações sem problema."}]}]},dir:"\u002Fblog",path:"\u002Fblog\u002F2015-01-12-instalando-o-ubuntu-1410-no-sony-vaio",extension:".md",createdAt:v,updatedAt:v,bodyPlainText:"\n# Instalando o Ubuntu 14.10 no Sony Vaio (Problemas com o SSD)\n\nHoje instalei em dual-boot o Ubuntu 14.10 e o windows 8.\nNão tive problemas com o UEFI, nem secure boot.\nNão tenho certeza, mas talvez o windows não seja o que veio\nde fábrica.\n\nEu já tinha um USB com o Ubuntu 14.10, então pluguei-o\ne bootei o computador.\nF12-F12-F12-F12... A tela de seleção de boot não apareceu,\nmas o usb foi escolhido automaticamente.\n\nO ubuntu bootou e selecionei instalar.\nEscolhi o particionamento manual,\nque é minha escolha usual.\nNormalmente faço o particionamento manual,\nporque não gosto quando eles criam (criavam, não sei\nse continuam) apenas o `\u002F` e o `swap`.\nO windows estava instalado em duas partições num SSD.\nSelecionei a correspondente, redimensionei, criei 3 partições lógicas\n(`\u002F`, `swap`, e `\u002Fhome`), e mandei instalar.\nA instalação não teve problemas. Aí eu bootei e deu erro.\n\nO primeiro erro que apareceu foi\n\n```\ntpm_tis: A TPM error (6) occurred attempting to read a pcr value\n```\n\nQue depois descobri que era proveniente do\n[Trusted Platform Module](https:\u002F\u002Fwiki.archlinux.org\u002Findex.php\u002FTPM).\nDepois de pouca busca, descobri que bastava entrar na BIOS e habilitar o\nTPM. A saber, para entrar na BIOS no Sony Vaio, desligue o computador e\naperte o botão ASSIST.\nHabilitei o TPM, mas não sei o que ele faz na prática. No entanto,\naparentemente, o computador continuou funcionando normalmente.\n\nO segundo erro que apareceu, que já aparecia junto com o primeiro, mas\nque só olhei depois, foi algo na linha de\n\n```\n[ 9.115544] ata9: exception Emask 0x0 SAct 0xf SErr 0x0 action 0x10 frozen\n[ 9.115550] ata9.00: failed command: READ FPDMA QUEUED\n[ 9.115556] ata9.00: cmd 60\u002F04:00:d4:82:85\u002F00:00:1f:00:00\u002F40 tag 0 ncq 2048 in\n[ 9.115557] res 40\u002F00:18:d3:82:85\u002F00:00:1f:00:00\u002F40 Emask 0x4 (timeout)\n```\n\nApós alguma busca descobri ser um erro de Native Command Queueing com SSDs.\nA solução\n[[1]](http:\u002F\u002Fsteffankarger.nl\u002F2013\u002F12\u002F10\u002Fubuntu-13-10-on-the-sony-vaio-pro-13\u002F)\n[[2]](http:\u002F\u002Fwww.howtoeverything.net\u002Flinux\u002Fhardware\u002Fubuntu-freeze-issue-after-ssd-upgrade)\n[[3]](https:\u002F\u002Fwiki.archlinux.org\u002Findex.php\u002FSolid_State_Drives#Resolving_NCQ_Errors)\nfoi adicionar `libata.force=noncq` na configuração do grub.\nPara isso, resumindo a referência, boot no live,\nmonte o `\u002F` com bind pro `\u002Fdev`, `\u002Fsys` e `\u002Fproc`, e se tiver separado, o `\u002Fboot`\ntambém. Os comandos a seguir fazem isso, supondo `\u002F` instalado no `\u002Fdev\u002Fsda5`.\n\n```\n$ sudo mount \u002Fdev\u002Fsda5 \u002Fmnt\n$ sudo mount --bind \u002Fdev \u002Fmnt\u002Fdev\n$ sudo mount --bind \u002Fsys \u002Fmnt\u002Fsys\n$ sudo mount --bind \u002Fproc \u002Fmnt\u002Fproc\n```\n\nDaí, entre nesse sistema com\n\n```\n$ sudo chroot \u002Fmnt\n```\n\nNo sistema novo, edite o arquivo `\u002Fetc\u002Fdefault\u002Fgrub`, modificando a linha\n\n```\nGRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash\"\n```\n\npara\n\n```\nGRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash libata.force=noncq\"\n```\n\ne atualize o grub com\n\n```\n$ sudo update-grub\n```\n\nSaia e desmonte as partições\n\n```\n$ exit\n$ sudo umount -R \u002Fmnt\n```\n\nPor fim é só reiniciar e ver se funcionou.\n\nAgora, a parte divertida dessa instalação, que durou quase 3 horas (!) foi em\nalgum lugar eu li, ou achei ter lido `libdata` no lugar de `libata`, e pareceu\nque essa solução não resolveu. E isso não é o pior, eu cheguei a buscar\n`libdata.force=noncq`, o google me corrigiu pra `libata.force=noncq`, e eu\ncheguei a ler depois o `libata` e achei que era outra opção.\n\nMas tirando isso, instalações sem problema.\n"},prev:{slug:"2015-01-16-selecting-a-subgroup-of-cutest-problems-according-to-specific-criteria",title:"Selecting a Subgroup of CUTEst Problems According to Specific Criteria"},next:{slug:"2015-01-08-cutest-com-matlab",title:"CUTEst Com Matlab"}}],fetch:{},mutations:void 0}}("text","element","code","\n","p","div","nuxt-content-highlight","pre","language-text","line-numbers","a","\u002F","nofollow","noopener","noreferrer","_blank","Instalando o Ubuntu 14.10 no Sony Vaio (Problemas com o SSD)","swap",", ","libata.force=noncq","libata","2022-12-23T17:39:35.597Z")));